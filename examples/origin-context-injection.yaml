# origin-context-injection.yaml
#
# Example configuration for automatic origin context injection into subagent spawns.
#
# This hook automatically appends an [origin: ...] tag to every sessions_spawn call,
# preserving the parent session's topic, chat, and sender information in spawned subagents.
#
# Use case: When a subagent is spawned from a forum topic, this ensures the subagent
# knows which topic/chat/sender originated the request, even after context compaction.

version: "1"

hooks:
  # Inject origin context into all sessions_spawn calls
  - point: turn:tool:pre
    match:
      tool: sessions_spawn
    action: inject_origin
    enabled: true

  # Optional: Also inject for subagent spawns (if subagents spawn their own subagents)
  - point: subagent:tool:pre
    match:
      tool: sessions_spawn
    action: inject_origin
    enabled: true

defaults:
  onFailure:
    action: continue  # Non-blocking: if injection fails, allow the spawn to proceed
    notifyUser: false
